<UserControl
    x:Class="EModbus.Views.SlaveView"
    xmlns="https://github.com/avaloniaui"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:shadui="clr-namespace:ShadUI;assembly=ShadUI"
    xmlns:vm="clr-namespace:EModbus.ViewModels"
    d:DesignHeight="450"
    d:DesignWidth="800"
    x:DataType="vm:SlaveViewModel"
    mc:Ignorable="d">
    <StackPanel Spacing="16" Margin="0,16,0,0">
        <!-- 状态卡片 -->
        <shadui:Card>
            <shadui:Card.Header>
                <StackPanel Spacing="4">
                    <TextBlock Classes="h3" Text="从站状态" />
                    <TextBlock Classes="Muted" Text="Modbus TCP 从站模拟器" />
                </StackPanel>
            </shadui:Card.Header>
            <shadui:Card.Content>
                <Grid ColumnDefinitions="*,Auto" RowDefinitions="Auto,Auto,Auto,Auto" Margin="0,8,0,0">
                    <TextBlock Grid.Row="0" Grid.Column="0" Text="监听地址" VerticalAlignment="Center" />
                    <TextBlock Grid.Row="0" Grid.Column="1" Text="{Binding SlaveSettings.IpAddress}" Classes="Muted" />

                    <TextBlock Grid.Row="1" Grid.Column="0" Text="端口号" VerticalAlignment="Center" Margin="0,8,0,0" />
                    <TextBlock Grid.Row="1" Grid.Column="1" Text="{Binding SlaveSettings.Port}" Classes="Muted" Margin="0,8,0,0" />

                    <TextBlock Grid.Row="2" Grid.Column="0" Text="从站ID" VerticalAlignment="Center" Margin="0,8,0,0" />
                    <TextBlock Grid.Row="2" Grid.Column="1" Text="{Binding SlaveSettings.SlaveId}" Classes="Muted" Margin="0,8,0,0" />

                    <TextBlock Grid.Row="3" Grid.Column="0" Text="运行状态" VerticalAlignment="Center" Margin="0,8,0,0" />
                    <TextBlock Grid.Row="3" Grid.Column="1" Text="{Binding SlaveStatus}" 
                               Classes.Success="{Binding IsSlaveRunning}"
                               Classes.Muted="{Binding !IsSlaveRunning}"
                               Margin="0,8,0,0" />
                </Grid>
            </shadui:Card.Content>
            <shadui:Card.Footer>
                <StackPanel Orientation="Horizontal" Spacing="12" HorizontalAlignment="Right">
                    <Button Content="启动从站" Classes="Primary" 
                            Command="{Binding StartSlaveCommand}" 
                            IsEnabled="{Binding !IsSlaveRunning}" />
                    <Button Content="停止从站" Classes="Destructive" 
                            Command="{Binding StopSlaveCommand}" 
                            IsEnabled="{Binding IsSlaveRunning}" />
                </StackPanel>
            </shadui:Card.Footer>
        </shadui:Card>

        <!-- 日志卡片 -->
        <shadui:Card>
            <shadui:Card.Header>
                <Grid ColumnDefinitions="*,Auto">
                    <StackPanel Grid.Column="0" Spacing="4">
                        <TextBlock Classes="h3" Text="运行日志" />
                        <TextBlock Classes="Muted" Text="从站运行过程中的日志记录" />
                    </StackPanel>
                    <Button Grid.Column="1" Content="清空" Classes="Outline" 
                            Command="{Binding ClearSlaveLogCommand}" VerticalAlignment="Center" />
                </Grid>
            </shadui:Card.Header>
            <shadui:Card.Content>
                <Border Height="200" BorderBrush="{DynamicResource BorderBrush}" BorderThickness="1" CornerRadius="4">
                    <ScrollViewer HorizontalScrollBarVisibility="Disabled" VerticalScrollBarVisibility="Auto" Padding="8">
                        <TextBlock Text="{Binding SlaveLog}" TextWrapping="Wrap" />
                    </ScrollViewer>
                </Border>
            </shadui:Card.Content>
        </shadui:Card>
    </StackPanel>
</UserControl>
